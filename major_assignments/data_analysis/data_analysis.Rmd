---
title: "Data Analysis Project"
author: "Kassidy, Maddie, Cassidie"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
options(scipen=999)
library(tidyverse)
library(lubridate)
library(refinr)
library(tidycensus)
install.packages("censusxy")
library(censusxy)

library(janitor)
library(sf)
library(tigris)
install.packages("usmap")
library(usmap)

```

## Load and Cleaning Data

```{r}
# Load required data
fatal_shootings<- read_csv("data/fatal-police-shootings-data.csv") 
# Clean required data and prepare for analysis if needed. 
census_api_key("0105753aba54d204fb6c33c44044ae59449b3773", overwrite =TRUE)
```



### Question 1
*Are police shootings happening mostly in majority-black communities, even when the victim is not black?

```{r}
fatal_shootings<- read_csv("data/fatal-police-shootings-data.csv") 
filter(!is.na(longitude)) 
fatal_shootings <- tibble()

row_number = 1

for (row_number in 1:nrow(fatal_shootings)) {

#making shooting dataframe one row
  
row_df<- fatal_shootings %>%
  slice(row_number)
   longitude <- row_df$longitude
  latitude <- row_df$latitude
  census_results <- cxy_geography(longitude, latitude) %>%
    select(Census.Tracts.GEOID) %>%
    clean_names()
 
   row_df <- row_df %>%
     bind_cols(census_results) %>%
  shootings <- fatal_shootings %>%
    bind_rows(row_df) 
   
   print(paste0("finished ", row_number, " ", Sys.time()))
   
   if (row_number%%500 == 0) {
     filepath <- paste0("data/geocoded_results_", row_number, ".rds")
     write_rds(fatal_shootings, filepath)
    shootings <- as_tibble()
     
   }
     
}


```

### Question 2
*Do these shootings mostly occur in low income areas? 

```{r}
```

### Question 3
*Are police shootings still happening disproportionately affecting black people regardless of the area (even in white neighborhoods)?

```{r}
```


-30-
